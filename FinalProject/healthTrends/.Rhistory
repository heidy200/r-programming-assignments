selected = "POPESTIMATE2011")
),
mainPanel(
plotOutput("scatterPlot", height = "400px")
)
)
)
# Chunk 3
server <- function(input, output) {
# Write your code here.
output$scatterPlot <- renderPlot({
ggplot(census_data, aes_string(
x = input$xvar,
y = input$yvar,
color = input$colorvar,
size = input$sizevar
)) +
geom_point(alpha = 0.7) +
scale_color_gradient(low = "lightblue", high = "darkblue") +
scale_size_continuous(range = c(2, 6)) +
theme_minimal() +
labs(
title = paste("Scatter Plot of", input$yvar, "vs", input$xvar),
x = input$xvar,
y = input$yvar,
color = input$colorvar,
size = input$sizevar
)
})
}
# Chunk 4
# Write your code here.
shinyApp(ui = ui, server = server)
# Chunk 1: setup
# Add your library below.
library(shiny)
library(ggplot2)
library(readr)
library(dplyr)
# Load census data
url <- "http://www2.census.gov/programs-surveys/popest/tables/2010-2011/state/totals/nst-est2011-01.csv"
census_data <- read_csv(url, skip = 8, col_names = TRUE, show_col_types = FALSE)  # skip the header rows
# Keep only the first 51 rows (states + DC)
census_data <- census_data[1:51, ]
# Clean column names
names(census_data) <- make.names(names(census_data))
# Manually assign column names
colnames(census_data) <- c(
"State", "CENSUS2010POP", "ESTIMATESBASE2010", "POPESTIMATE2010", "POPESTIMATE2011",
"Change", "PercentChange", "Notes1", "Notes2", "Notes3"
)
# Keep only numeric columns for plotting
numeric_cols <- names(census_data)[sapply(census_data, is.numeric)]
# Chunk 2
ui <- fluidPage(
# Write your code here.
titlePanel("Census Data Interactive Scatter Plot"),
sidebarLayout(
sidebarPanel(
selectInput("xvar", "X-axis:",
choices = numeric_cols,
selected = "POPESTIMATE2010"),
selectInput("yvar", "Y-axis:",
choices = numeric_cols,
selected = "POPESTIMATE2011"),
selectInput("sizevar", "Size:",
choices = numeric_cols,
selected = "POPESTIMATE2011")
),
mainPanel(
plotOutput("scatterPlot", height = "400px")
)
)
)
# Chunk 3
server <- function(input, output) {
# Write your code here.
ggplot(dfStates, aes(
x = variable_for_x,        # e.g., region, state, or whatever you’re plotting on X
y = variable_for_y,        # maybe growth rate or rank
color = POPESTIMATE2010,   # gradient based on 2010 population
size = POPESTIMATE2011     # size based on 2011 population
)) +
geom_point(alpha = 0.7) +
scale_color_gradient(low = "lightblue", high = "darkblue") +
theme_gray() +
labs(
title = "U.S. State Population Trends (2010–2011)",
x = "State or Region",
y = "Population Change or Other Metric",
color = "2010 Population",
size = "2011 Population"
)
# Chunk 4
# Write your code here.
shinyApp(ui = ui, server = server)
# Chunk 1: setup
# Add your library below.
library(shiny)
library(ggplot2)
library(readr)
library(dplyr)
# Load census data
url <- "http://www2.census.gov/programs-surveys/popest/tables/2010-2011/state/totals/nst-est2011-01.csv"
census_data <- read_csv(url, skip = 8, col_names = TRUE, show_col_types = FALSE)  # skip the header rows
# Keep only the first 51 rows (states + DC)
census_data <- census_data[1:51, ]
# Clean column names
names(census_data) <- make.names(names(census_data))
# Manually assign column names
colnames(census_data) <- c(
"State", "CENSUS2010POP", "ESTIMATESBASE2010", "POPESTIMATE2010", "POPESTIMATE2011",
"Change", "PercentChange", "Notes1", "Notes2", "Notes3"
)
# Keep only numeric columns for plotting
numeric_cols <- names(census_data)[sapply(census_data, is.numeric)]
# Chunk 2
ui <- fluidPage(
# Write your code here.
titlePanel("Census Data Interactive Scatter Plot"),
sidebarLayout(
sidebarPanel(
selectInput("xvar", "X-axis:",
choices = numeric_cols,
selected = "POPESTIMATE2010"),
selectInput("yvar", "Y-axis:",
choices = numeric_cols,
selected = "POPESTIMATE2011"),
selectInput("sizevar", "Size:",
choices = numeric_cols,
selected = "POPESTIMATE2011")
),
mainPanel(
plotOutput("scatterPlot", height = "400px")
)
)
)
# Chunk 3
server <- function(input, output) {
# Write your code here.
ggplot(dfStates, aes(
x = variable_for_x,        # e.g., region, state, or whatever you’re plotting on X
y = variable_for_y,        # maybe growth rate or rank
color = POPESTIMATE2010,   # gradient based on 2010 population
size = POPESTIMATE2011     # size based on 2011 population
)) +
geom_point(alpha = 0.7) +
scale_color_gradient(low = "lightblue", high = "darkblue") +
theme_gray() +
labs(
title = "U.S. State Population Trends (2010–2011)",
x = "State or Region",
y = "Population Change or Other Metric",
color = "2010 Population",
size = "2011 Population"
)
# Chunk 4
# Write your code here.
shinyApp(ui = ui, server = server)
# Chunk 1: setup
# Add your library below.
library(shiny)
library(ggplot2)
library(readr)
library(dplyr)
# Load census data
url <- "http://www2.census.gov/programs-surveys/popest/tables/2010-2011/state/totals/nst-est2011-01.csv"
census_data <- read_csv(url, skip = 8, col_names = TRUE, show_col_types = FALSE)  #
census_data <- census_data[1:51, ]
# Clean column names
names(census_data) <- make.names(names(census_data))
# Manually assign column names
colnames(census_data) <- c(
"State", "CENSUS2010POP", "ESTIMATESBASE2010", "POPESTIMATE2010", "POPESTIMATE2011",
"Change", "PercentChange", "Notes1", "Notes2", "Notes3"
)
numeric_cols <- names(census_data)[sapply(census_data, is.numeric)]
# Chunk 2
ui <- fluidPage(
# Write your code here.
titlePanel("U.S. Census Population Data (2010–2011)"),
sidebarLayout(
sidebarPanel(
selectInput("xvar", "Select X-axis Variable:", choices = numeric_cols, selected = "POPESTIMATE2010"),
selectInput("yvar", "Select Y-axis Variable:", choices = numeric_cols, selected = "POPESTIMATE2011"),
selectInput("sizevar", "Select Size Variable:", choices = numeric_cols, selected = "POPESTIMATE2011")
),
mainPanel(
plotOutput("scatterPlot", height = "400px")
)
)
)
# Chunk 3
server <- function(input, output) {
# Write your code here.
output$scatterPlot <- renderPlot({
ggplot(census_data, aes(
x = .data[[input$xvar]],
y = .data[[input$yvar]],
color = POPESTIMATE2010,
size = .data[[input$sizevar]]
)) +
geom_point(alpha = 0.7) +
scale_color_gradient(low = "lightblue", high = "darkblue") +
theme_minimal() +
labs(
title = "U.S. State Population Trends (2010–2011)",
x = input$xvar,
y = input$yvar,
color = "2010 Population",
size = "2011 Population"
)
})
}
# Chunk 4
# Write your code here.
shinyApp(ui = ui, server = server)
# Chunk 1: setup
# Add your library below.
library(shiny)
library(ggplot2)
library(readr)
library(dplyr)
# Load census data
url <- "http://www2.census.gov/programs-surveys/popest/tables/2010-2011/state/totals/nst-est2011-01.csv"
census_data <- read_csv(url, skip = 8, col_names = TRUE, show_col_types = FALSE)  #
census_data <- census_data[1:51, ]
# Clean column names
names(census_data) <- make.names(names(census_data))
# Manually assign column names
colnames(census_data) <- c(
"State", "CENSUS2010POP", "ESTIMATESBASE2010", "POPESTIMATE2010", "POPESTIMATE2011",
"Change", "PercentChange", "Notes1", "Notes2", "Notes3"
)
numeric_cols <- names(census_data)[sapply(census_data, is.numeric)]
# Chunk 2
ui <- fluidPage(
# Write your code here.
titlePanel("U.S. Census Population Data (2010–2011)"),
sidebarLayout(
sidebarPanel(
selectInput("xvar", "Select X-axis Variable:", choices = numeric_cols, selected = "POPESTIMATE2010"),
selectInput("yvar", "Select Y-axis Variable:", choices = numeric_cols, selected = "POPESTIMATE2011"),
selectInput("sizevar", "Select Size Variable:", choices = numeric_cols, selected = "POPESTIMATE2011")
),
mainPanel(
plotOutput("scatterPlot", height = "400px")
)
)
)
# Chunk 3
server <- function(input, output) {
# Write your code here.
output$scatterPlot <- renderPlot({
ggplot(census_data, aes(
x = .data[[input$xvar]],
y = .data[[input$yvar]],
color = POPESTIMATE2010,
size = .data[[input$sizevar]]
)) +
geom_point(alpha = 0.7) +
scale_color_gradient(low = "lightblue", high = "darkblue") +
theme_minimal() +
labs(
title = "U.S. State Population Trends (2010–2011)",
x = input$xvar,
y = input$yvar,
color = "2010 Population",
size = "2011 Population"
)
})
}
# Chunk 4
# Write your code here.
shinyApp(ui = ui, server = server)
# Chunk 1: setup
# Add your library below.
library(shiny)
library(ggplot2)
library(readr)
library(dplyr)
# Load census data
url <- "http://www2.census.gov/programs-surveys/popest/tables/2010-2011/state/totals/nst-est2011-01.csv"
census_data <- read_csv(url, skip = 8, col_names = TRUE, show_col_types = FALSE)  #
census_data <- census_data[1:51, ]
# Clean column names
names(census_data) <- make.names(names(census_data))
# Manually assign column names
colnames(census_data) <- c(
"State", "CENSUS2010POP", "ESTIMATESBASE2010", "POPESTIMATE2010", "POPESTIMATE2011",
"Change", "PercentChange", "Notes1", "Notes2", "Notes3"
)
numeric_cols <- names(census_data)[sapply(census_data, is.numeric)]
# Chunk 2
ui <- fluidPage(
# Write your code here.
titlePanel("U.S. Census Population Data (2010–2011)"),
sidebarLayout(
sidebarPanel(
selectInput("xvar", "Select X-axis Variable:", choices = numeric_cols, selected = "POPESTIMATE2010"),
selectInput("yvar", "Select Y-axis Variable:", choices = numeric_cols, selected = "POPESTIMATE2011"),
selectInput("sizevar", "Select Size Variable:", choices = numeric_cols, selected = "POPESTIMATE2011")
),
mainPanel(
plotOutput("scatterPlot", height = "400px")
)
)
)
# Chunk 3
server <- function(input, output) {
# Write your code here.
output$scatterPlot <- renderPlot({
ggplot(census_data, aes(
x = .data[[input$xvar]],
y = .data[[input$yvar]],
color = POPESTIMATE2010,
size = .data[[input$sizevar]]
)) +
geom_point(alpha = 0.7) +
scale_color_gradient(low = "lightblue", high = "darkblue") +
theme_minimal() +
labs(
title = "U.S. State Population Trends (2010–2011)",
x = input$xvar,
y = input$yvar,
color = "2010 Population",
size = "2011 Population"
)
})
}
# Chunk 4
# Write your code here.
shinyApp(ui = ui, server = server)
# Chunk 1: setup
# Add your library below.
library(shiny)
library(ggplot2)
library(readr)
library(dplyr)
# Load census data
url <- "http://www2.census.gov/programs-surveys/popest/tables/2010-2011/state/totals/nst-est2011-01.csv"
census_data <- read_csv(url, skip = 8, col_names = TRUE, show_col_types = FALSE)  #
census_data <- census_data[1:51, ]
# Clean column names
names(census_data) <- make.names(names(census_data))
# Manually assign column names
colnames(census_data) <- c(
"State", "CENSUS2010POP", "ESTIMATESBASE2010", "POPESTIMATE2010", "POPESTIMATE2011",
"Change", "PercentChange", "Notes1", "Notes2", "Notes3"
)
numeric_cols <- names(census_data)[sapply(census_data, is.numeric)]
# Chunk 2
ui <- fluidPage(
# Write your code here.
titlePanel("U.S. Census Population Data (2010–2011)"),
sidebarLayout(
sidebarPanel(
selectInput("xvar", "Select X-axis Variable:", choices = numeric_cols, selected = "POPESTIMATE2010"),
selectInput("yvar", "Select Y-axis Variable:", choices = numeric_cols, selected = "POPESTIMATE2011"),
selectInput("sizevar", "Select Size Variable:", choices = numeric_cols, selected = "POPESTIMATE2011")
),
mainPanel(
plotOutput("scatterPlot", height = "400px")
)
)
)
# Chunk 3
server <- function(input, output) {
# Write your code here.
output$scatterPlot <- renderPlot({
ggplot(census_data, aes(
x = .data[[input$xvar]],
y = .data[[input$yvar]],
color = POPESTIMATE2010,
size = .data[[input$sizevar]]
)) +
geom_point(alpha = 0.7) +
scale_color_gradient(low = "lightblue", high = "darkblue") +
theme_minimal() +
labs(
title = "U.S. State Population Trends (2010–2011)",
x = input$xvar,
y = input$yvar,
color = "2010 Population",
size = "2011 Population"
)
})
}
# Chunk 4
# Write your code here.
shinyApp(ui = ui, server = server)
# Helper function: Tukey outlier rule
tukey.outlier <- function(x) {
q1 <- quantile(x, 0.25, na.rm = TRUE)
q3 <- quantile(x, 0.75, na.rm = TRUE)
iqr <- q3 - q1
x < (q1 - 1.5 * iqr) | x > (q3 + 1.5 * iqr)
}
# Main function: Flags rows that are outliers in every column
tukey_multiple <- function(x) {
# Defensive checks
if (!is.matrix(x)) stop("Input must be a matrix.")
if (!is.numeric(x)) stop("Matrix must be numeric.")
outliers <- array(TRUE, dim = dim(x))
for (j in seq_len(ncol(x))) {
outliers[, j] <- outliers[, j] & tukey.outlier(x[, j])
}
outlier.vec <- logical(nrow(x))
for (i in seq_len(nrow(x))) {
outlier.vec[i] <- all(outliers[i, ])
}
return(outlier.vec)
}
# Test the function
set.seed(123)
test_mat <- matrix(rnorm(50), nrow = 10)
tukey_multiple(test_mat)
# Orignal code
tukey_multiple <- function(x) {
outliers <- array(TRUE, dim = dim(x))
for (j in 1:ncol(x)) {
outliers[, j] <- outliers[, j] && tukey.outlier(x[, j])
}
outlier.vec <- vector("logical", length = nrow(x))
for (i in 1:nrow(x)) {
outlier.vec[i] <- all(outliers[i, ])
}
return(outlier.vec)
}
set.seed(123)
test_mat <- matrix(rnorm(50), nrow = 10)
tukey_multiple(test_mat)
# Corrected function
corrected_tukey <- function(x) {
# Defensive checks
if (!is.matrix(x)) {
stop("Error: Input must be a matrix.")
}
if (!is.numeric(x)) {
stop("Error: Matrix must contain only numeric values.")
}
if (nrow(x) == 0 || ncol(x) == 0) {
stop("Error: Matrix cannot be empty.")
}
# Initialize logical array
outliers <- array(TRUE, dim = dim(x))
# Apply Tukey rule for each column
for (j in seq_len(ncol(x))) {
qnt <- quantile(x[, j], probs = c(0.25, 0.75))
H <- 1.5 * IQR(x[, j])
col_outliers <- (x[, j] < (qnt[1] - H)) | (x[, j] > (qnt[2] + H))
outliers[, j] <- outliers[, j] & col_outliers
}
# Check for rows that are outliers in all columns
outlier.vec <- apply(outliers, 1, all)
return(outlier.vec)
}
# Test the function
set.seed(123)
test_mat <- matrix(rnorm(50), nrow = 10)
corrected_tukey(test_mat)
tukey_multiple <- function(x) {
outliers <- array(TRUE, dim = dim(x))
for (j in 1:ncol(x)) {
outliers[, j] <- outliers[, j] && tukey.outlier(x[, j])
}
outlier.vec <- vector("logical", length = nrow(x))
for (i in 1:nrow(x)) {
outlier.vec[i] <- all(outliers[i, ])
}
return(outlier.vec)
}
set.seed(123)
test_mat <- matrix(rnorm(50), nrow = 10)
tukey_multiple(test_mat)
# Helper function: Tukey outlier rule
tukey.outlier <- function(x) {
q1 <- quantile(x, 0.25, na.rm = TRUE)
q3 <- quantile(x, 0.75, na.rm = TRUE)
iqr <- q3 - q1
x < (q1 - 1.5 * iqr) | x > (q3 + 1.5 * iqr)
}
# Corrected function with defensive checks
corrected_tukey <- function(x) {
if (!is.matrix(x)) stop("Input must be a matrix.")
if (!is.numeric(x)) stop("Matrix must contain only numeric values.")
outliers <- array(TRUE, dim = dim(x))
for (j in seq_len(ncol(x))) {
outliers[, j] <- outliers[, j] & tukey.outlier(x[, j])
}
outlier.vec <- logical(nrow(x))
for (i in seq_len(nrow(x))) {
outlier.vec[i] <- all(outliers[i, ])
}
return(outlier.vec)
}
set.seed(123)
test_mat <- matrix(rnorm(50), nrow = 10)
print(corrected_tukey(test_mat))
library(devtools)
create_package("healthTrends")
setwd("~/Documents/FinalProject/healthTrends")
install.packages("knitr")
install.packages("rmarkdown")
install.packages("rmarkdown")
install.packages("knitr")
devtools::document()
devtools::build_vignettes()
devtools::document()
devtools::build_vignettes()
devtools::document()
devtools::build_vignettes()
